import{bB as e,bC as Ue,bD as ys,r,bE as Et,bF as ws,bG as vs,bH as Cs,bI as Z,bJ as js,bK as Ts,bL as Is,bM as ks,bN as Ls,bO as As,bP as Fs,bQ as Ns,bR as Rs,bS as Ps,bT as Es}from"./vendor-2e98d0fc.js";import{e as Ms,E as Us,M as vt,f as qs,D as Mt,g as Bs,h as Os}from"./fluentui-icons-c66373d2.js";import{I as X,S as v,P as Vs,T as Re,B as Y,a as z,u as Gs,b as g,C as Ut,D as qe,c as $s,d as Ds,M as Hs,e as zs,L as Qs,f as Ws,g as Ct,h as qt,i as le,j as Pe,k as jt,l as Ks,m as Js,n as Tt,o as Xs,p as Ys,q as Zs,r as Q,s as en}from"./fluentui-react-42c9a914.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const d of a)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function s(a){const d={};return a.integrity&&(d.integrity=a.integrity),a.referrerPolicy&&(d.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?d.credentials="include":a.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function i(a){if(a.ep)return;a.ep=!0;const d=s(a);fetch(a.href,d)}})();const tn="_container_ggo0d_1",sn="_chatRoot_ggo0d_8",nn="_chatContainer_ggo0d_13",on="_chatEmptyState_ggo0d_21",an="_chatEmptyStateTitle_ggo0d_31",rn="_chatEmptyStateSubtitle_ggo0d_38",ln="_chatMessageStream_ggo0d_54",cn="_chatMessageGpt_ggo0d_66",dn="_chatMessageGptMinWidth_ggo0d_73",un="_chatInput_ggo0d_78",hn="_chatAnalysisPanel_ggo0d_91",pn="_chatSettingsSeparator_ggo0d_99",gn="_loadingLogo_ggo0d_105",mn="_commandsContainer_ggo0d_109",xn="_commandButton_ggo0d_114",x={container:tn,chatRoot:sn,chatContainer:nn,chatEmptyState:on,chatEmptyStateTitle:an,chatEmptyStateSubtitle:rn,chatMessageStream:ln,chatMessageGpt:cn,chatMessageGptMinWidth:dn,chatInput:un,chatAnalysisPanel:hn,chatSettingsSeparator:pn,loadingLogo:gn,commandsContainer:mn,commandButton:xn},fn=".auth/me",bn=".auth/refresh",Sn=".auth/logout?post_logout_redirect_uri=/";async function _n(){const t=await fetch("/auth_setup");if(!t.ok)throw new Error(`auth setup response was not ok: ${t.status}`);return await t.json()}const K=await _n(),G=K.useLogin,ue=K.requireAccessControl,yn=K.enableUnauthenticatedAccess,It=ue&&!yn,wn=K.msalConfig,vn=K.loginRequest,Cn=K.tokenRequest,Bt=()=>window.location.origin+K.msalConfig.auth.redirectUri;globalThis.cachedAppServicesToken=null;const me=()=>{const t=s=>{const i=new Date;return new Date(s.expires_on)>i};if(globalThis.cachedAppServicesToken&&t(globalThis.cachedAppServicesToken))return Promise.resolve(globalThis.cachedAppServicesToken);const n=()=>fetch(fn).then(s=>s.ok?s.json().then(i=>i.length>0?{id_token:i[0].id_token,access_token:i[0].access_token,user_claims:i[0].user_claims.reduce((a,d)=>(a[d.typ]=d.val,a),{}),expires_on:i[0].expires_on}:null):null);return n().then(s=>s?t(s)?(globalThis.cachedAppServicesToken=s,s):fetch(bn).then(i=>i.ok?n():null):null)},jn=await me()!=null,Tn=()=>{window.location.href=Sn},Ee=async t=>!!(t&&t.getActiveAccount()||await me()),he=async t=>{const n=await me();return n?Promise.resolve(n.access_token):t.acquireTokenSilent({...Cn,redirectUri:Bt()}).then(s=>s.accessToken).catch(s=>{console.log(s)})},Ce=async t=>{const n=t.getActiveAccount();if(n)return kt(n.name)||n.username;const s=await me();return s?.user_claims?kt(s.user_claims.name)||s.user_claims.preferred_username:null};function kt(t){return t&&t.split(" ")[0]||null}const In=async t=>{const n=t.getActiveAccount();if(n)return n.idTokenClaims;const s=await me();if(s)return s.user_claims},Be="";async function xe(t){return G&&!jn&&t?{Authorization:`Bearer ${t}`}:{}}async function kn(){return await(await fetch(`${Be}/config`,{method:"GET"})).json()}async function Ln(t,n,s){let i=`${Be}/chat`;n&&(i+="/stream");const a=await xe(s);return await fetch(i,{method:"POST",headers:{...a,"Content-Type":"application/json"},body:JSON.stringify(t)})}async function An(t){return await fetch("/speech",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t})}).then(n=>n.status==200?n.blob():n.status==400?(console.log("Speech synthesis is not enabled."),null):(console.error("Unable to get speech synthesis."),null)).then(n=>n?URL.createObjectURL(n):null)}function Ot(t){return`${Be}/content/${t}`}async function Fn(t,n){const s=await fetch("/upload",{method:"POST",headers:await xe(n),body:t});if(!s.ok)throw new Error(`Uploading files failed: ${s.statusText}`);return await s.json()}async function Nn(t,n){const s=await xe(n),i=await fetch("/delete_uploaded",{method:"POST",headers:{...s,"Content-Type":"application/json"},body:JSON.stringify({filename:t})});if(!i.ok)throw new Error(`Deleting file failed: ${i.statusText}`);return await i.json()}async function Rn(t){const n=await fetch("/list_uploaded",{method:"GET",headers:await xe(t)});if(!n.ok)throw new Error(`Listing files failed: ${n.statusText}`);return await n.json()}var F=(t=>(t.Hybrid="hybrid",t.Vectors="vectors",t.Text="text",t))(F||{}),V=(t=>(t.TextAndImages="textAndImages",t.Images="images",t.Texts="texts",t))(V||{}),M=(t=>(t.Embedding="embedding",t.ImageEmbedding="imageEmbedding",t.Both="both",t))(M||{});const Pn="_answerContainer_1sqax_1",En="_answerLogo_1sqax_11",Mn="_answerText_1sqax_15",Un="_selected_1sqax_34",qn="_citationLearnMore_1sqax_38",Bn="_citation_1sqax_38",On="_followupQuestionsList_1sqax_60",Vn="_followupQuestionLearnMore_1sqax_64",Gn="_followupQuestion_1sqax_60",$n="_supContainer_1sqax_83",Dn="_retryButton_1sqax_112",Hn="_loadingdots_1sqax_134",zn="_loading_1sqax_134",N={answerContainer:Pn,answerLogo:En,answerText:Mn,selected:Un,citationLearnMore:qn,citation:Bn,followupQuestionsList:On,followupQuestionLearnMore:Vn,followupQuestion:Gn,supContainer:$n,retryButton:Dn,loadingdots:Hn,loading:zn};function Qn(t){return t.split(/\*\*(.*?)\*\*/g).map((s,i)=>i%2===0?e.jsx(Ue.Fragment,{children:s},i):e.jsx("b",{children:s},i))}function Wn(t){return t.split(`
`).map(n=>n.startsWith("#")?`**${n.replace(/^#+\s*/,"").trim()}**`:n).join(`
`)}function Kn(t,n,s){const i=[];let a=Wn(t).trim();if(console.log("Entered Parser"),console.log("Processed Answer:",a),n){let l=a.length;for(let p=a.length-1;p>=0&&a[p]!=="]";p--)if(a[p]==="["){l=p;break}a=a.substring(0,l),console.log("Truncated Answer:",a)}const h=a.split(/\[([^\]]+)\]/g).map((l,u)=>{if(u%2===0)return Qn(l);{let p;i.indexOf(l)!==-1?p=i.indexOf(l)+1:(i.push(l),p=i.length);const b=Ot(l);return e.jsxs(Ue.Fragment,{children:[" ",e.jsx("a",{className:"supContainer",title:l,onClick:()=>s(b),children:e.jsx("sup",{children:p})})]},u)}});return{answerHtml:ys(e.jsx(e.Fragment,{children:h})),citations:i}}const Vt=()=>e.jsx(Ms,{primaryFill:"rgba(36,189,177,255)","aria-hidden":"true","aria-label":"Answer logo"}),Jn=window.speechSynthesis||window.webkitSpeechSynthesis;let W=null;try{W=Jn}catch{console.error("SpeechSynthesis is not supported")}const Xn=function(t){if(W){const n=new SpeechSynthesisUtterance(t);return n.lang="en-US",n.volume=1,n.rate=1,n.pitch=1,n.voice=W.getVoices().filter(s=>s.lang==="en-US")[0],n}},Yn=({answer:t})=>{const[n,s]=r.useState(!1),i=d=>{if(W!=null){if(n){W.cancel(),s(!1);return}const h=Xn(d);if(!h)return;W.speak(h),h.onstart=()=>{s(!0)},h.onend=()=>{s(!1)}}},a=n?"red":"black";return e.jsx(X,{style:{color:a},iconProps:{iconName:"Volume3"},title:"Speak answer",ariaLabel:"Speak answer",onClick:()=>i(t),disabled:!W})};let we=new Audio;const Zn=({url:t})=>{const[n,s]=r.useState(!1),i=async()=>{if(n){we.pause(),s(!1);return}if(!t){console.error("Speech output is not yet available.");return}we=new Audio(t),await we.play(),we.addEventListener("ended",()=>{s(!1)}),s(!0)},a=n?"red":"black";return e.jsx(X,{style:{color:a},iconProps:{iconName:"Volume3"},title:"Speak answer",ariaLabel:"Speak answer",onClick:()=>i(),disabled:!t})},eo=t=>navigator.clipboard?navigator.clipboard.writeText(t).then(()=>{console.log("Text successfully copied to clipboard")}).catch(n=>{throw console.error("Failed to copy text: ",n),n}):Promise.reject(new Error("Clipboard API not available")),Lt=({answer:t,question:n,isSelected:s,isStreaming:i,onCitationClicked:a,onThoughtProcessClicked:d,onSupportingContentClicked:h,onFollowupQuestionClicked:l,showFollowupQuestions:u,showSpeechOutputAzure:p,showSpeechOutputBrowser:b,speechUrl:w})=>{const y=t.context?.followup_questions,_=t.message.content,m=r.useMemo(()=>Kn(_,i,a),[t]),S=Et.sanitize(m.answerHtml),L=()=>{const C=t.message.content.replace(/\[\^\d+?\]/g,"");eo(C)};return e.jsxs(v,{className:`${N.answerContainer} ${s&&N.selected}`,verticalAlign:"space-between",children:[e.jsx(v.Item,{children:e.jsxs(v,{horizontal:!0,horizontalAlign:"space-between",children:[e.jsx(Vt,{}),e.jsxs("div",{children:[e.jsx(X,{style:{color:"black"},iconProps:{iconName:"Copy"},title:"Copy answer",ariaLabel:"Copy answer",onClick:L}),e.jsx(X,{style:{color:"black"},iconProps:{iconName:"ClipboardList"},title:"Show supporting content",ariaLabel:"Show supporting content",onClick:()=>h(),disabled:!t.context.data_points}),p&&e.jsx(Zn,{url:w}),b&&e.jsx(Yn,{answer:S})]})]})}),e.jsx(v.Item,{grow:!0,children:e.jsx("div",{className:N.answerText,dangerouslySetInnerHTML:{__html:S}})}),!!m.citations.length&&e.jsx(v.Item,{children:e.jsxs(v,{horizontal:!0,wrap:!0,tokens:{childrenGap:5},children:[e.jsx("span",{className:N.citationLearnMore,children:"Citations:"}),m.citations.map((C,U)=>{const ee=Ot(C);return e.jsx("a",{className:N.citation,title:C,onClick:()=>a(ee),children:`${++U}. ${C}`},U)})]})}),!!y?.length&&u&&l&&e.jsx(v.Item,{children:e.jsxs(v,{horizontal:!0,wrap:!0,className:`${m.citations.length?N.followupQuestionsList:""}`,tokens:{childrenGap:6},children:[e.jsx("span",{className:N.followupQuestionLearnMore,children:"Follow-up questions:"}),y.map((C,U)=>e.jsx("a",{className:N.followupQuestion,title:C,onClick:()=>l(C),children:`${C}`},U))]})})]})},to=()=>{const t=ws({from:{opacity:0},to:{opacity:1}});return e.jsx(vs.div,{style:{...t},children:e.jsxs(v,{className:N.answerContainer,verticalAlign:"space-between",children:[e.jsx(Vt,{}),e.jsx(v.Item,{grow:!0,children:e.jsxs("p",{className:N.answerText,children:["Generating answer",e.jsx("span",{className:N.loadingdots})]})})]})})},so=({error:t,onRetry:n})=>e.jsxs(v,{className:N.answerContainer,verticalAlign:"space-between",children:[e.jsx(Us,{"aria-hidden":"true","aria-label":"Error icon",primaryFill:"red"}),e.jsx(v.Item,{grow:!0,children:e.jsx("p",{className:N.answerText,children:t})}),e.jsx(Vs,{className:N.retryButton,onClick:n,text:"Retry"})]}),no="_questionInputContainer_1d7ip_1",oo="_questionInputTextArea_1d7ip_12",ao="_questionInputButtonsContainer_1d7ip_17",pe={questionInputContainer:no,questionInputTextArea:oo,questionInputButtonsContainer:ao},ro=window.speechRecognition||window.webkitSpeechRecognition;let A=null;try{A=new ro,A!=null&&(A.lang="en-US",A.interimResults=!0)}catch{console.error("SpeechRecognition not supported"),A=null}const io=({updateQuestion:t})=>{const[n,s]=r.useState(!1),i=()=>{if(A==null){console.error("SpeechRecognition not supported");return}A.onresult=d=>{let h="";for(const l of d.results)h+=l[0].transcript;t(h)},A.onend=()=>{s(!1)},A.onerror=d=>{A&&(A.stop(),d.error=="no-speech"?alert("No speech was detected. Please check your system audio settings and try again."):d.error=="language-not-supported"?alert(`Speech recognition error detected: ${d.error}. The speech recognition input functionality does not yet work on all browsers, like Edge in Mac OS X with ARM chips. Try another browser/OS.`):alert(`Speech recognition error detected: ${d.error}.`))},s(!0),A.start()},a=()=>{if(A==null){console.error("SpeechRecognition not supported");return}A.stop(),s(!1)};return A==null?e.jsx(e.Fragment,{}):e.jsxs(e.Fragment,{children:[!n&&e.jsx("div",{className:pe.questionInputButtonsContainer,children:e.jsx(Re,{content:"Ask question with voice",relationship:"label",children:e.jsx(Y,{size:"large",icon:e.jsx(vt,{primaryFill:"rgba(115, 118, 225, 1)"}),onClick:i})})}),n&&e.jsx("div",{className:pe.questionInputButtonsContainer,children:e.jsx(Re,{content:"Stop recording question",relationship:"label",children:e.jsx(Y,{size:"large",icon:e.jsx(vt,{primaryFill:"rgba(250, 0, 0, 0.7)"}),disabled:!n,onClick:a})})})]})},ge=r.createContext({loggedIn:!1,setLoggedIn:t=>{}}),lo=({onSend:t,disabled:n,placeholder:s,clearOnSend:i,initQuestion:a,showSpeechInput:d})=>{const[h,l]=r.useState(""),{loggedIn:u}=r.useContext(ge);r.useEffect(()=>{a&&l(a)},[a]);const p=()=>{n||!h.trim()||(t(h),i&&l(""))},b=m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),p())},w=(m,S)=>{S?S.length<=1e3&&l(S):l("")},y=It&&!u,_=n||!h.trim()||It;return y&&(s="Please login to continue..."),e.jsxs(v,{horizontal:!0,className:pe.questionInputContainer,children:[e.jsx(z,{className:pe.questionInputTextArea,disabled:y,placeholder:s,multiline:!0,resizable:!1,borderless:!0,value:h,onChange:w,onKeyDown:b}),e.jsx("div",{className:pe.questionInputButtonsContainer,children:e.jsx(Re,{content:"Submit question",relationship:"label",children:e.jsx(Y,{size:"large",icon:e.jsx(qs,{primaryFill:"rgba(36,189,177,255)"}),disabled:_,onClick:p})})}),d&&e.jsx(io,{updateQuestion:l})]})},co="_examplesNavList_13bpl_1",uo="_example_13bpl_1",ho="_exampleText_13bpl_29",Me={examplesNavList:co,example:uo,exampleText:ho},po=({text:t,value:n,onClick:s})=>e.jsx("div",{className:Me.example,onClick:()=>s(n),children:e.jsx("p",{className:Me.exampleText,children:t})}),go=["Which airlines are achieving their 2024 objectives?","Explain Tesla's margin compression in 2024.","What is Ford's strategy for electric vehicles?","Please list all the companies available in the system?"],mo=["Which airlines are achieving their 2024 objectives?","Explain Tesla's margin compression in 2024.","What is Ford's strategy for electric vehicles?","Please list all the companies available in the system?"],xo=({onExampleClicked:t,useGPT4V:n})=>e.jsx("ul",{className:Me.examplesNavList,children:(n?mo:go).map((s,i)=>e.jsx("li",{children:e.jsx(po,{text:s,value:s,onClick:t})},i))}),fo="_container_1xzug_1",bo="_message_1xzug_9",At={container:fo,message:bo},ve=({message:t})=>e.jsx("div",{className:At.container,children:e.jsx("div",{className:At.message,children:t})}),Ft={childrenGap:4,maxWidth:300},So={root:{padding:20}},_o={root:{marginBottom:-3}},yo={iconName:"Info"},I=t=>{const[n,{toggle:s}]=Gs(!1),i=g("description"),a=g("iconButton");return e.jsxs(e.Fragment,{children:[e.jsxs(v,{horizontal:!0,verticalAlign:"center",tokens:Ft,children:[e.jsx("label",{id:t.labelId,htmlFor:t.fieldId,children:t.label}),e.jsx(X,{id:a,iconProps:yo,title:"Info",ariaLabel:"Info",onClick:s,styles:_o})]}),n&&e.jsx(Ut,{target:"#"+a,setInitialFocus:!0,onDismiss:s,ariaDescribedBy:i,role:"alertdialog",children:e.jsxs(v,{tokens:Ft,horizontalAlign:"start",styles:So,children:[e.jsx("span",{id:i,children:t.helpText}),e.jsx(qe,{onClick:s,children:"Close"})]})})]})},wo="_thoughtProcess_1ywhx_1",vo="_tList_1ywhx_8",Co="_tListItem_1ywhx_14",jo="_tStep_1ywhx_40",To="_tCodeBlock_1ywhx_47",Io="_tProp_1ywhx_51",ko="_citationImg_1ywhx_60",Lo={thoughtProcess:wo,tList:vo,tListItem:Co,tStep:jo,tCodeBlock:To,tProp:Io,citationImg:ko};function Ao(t){const n=t.split(": "),s=n[0],i=Et.sanitize(n.slice(1).join(": "));return{title:s,content:i}}const Fo="_supportingContentNavList_beb5d_1",No="_supportingContentItem_beb5d_9",Ro="_supportingContentItemHeader_beb5d_23",Po="_supportingContentItemText_beb5d_27",Eo="_supportingContentItemImage_beb5d_32",ce={supportingContentNavList:Fo,supportingContentItem:No,supportingContentItemHeader:Ro,supportingContentItemText:Po,supportingContentItemImage:Eo},Mo=({supportingContent:t})=>{const n=Array.isArray(t)?t:t.text,s=Array.isArray(t)?[]:t?.images;return e.jsxs("ul",{className:ce.supportingContentNavList,children:[n.map((i,a)=>{const d=Ao(i);return e.jsxs("li",{className:ce.supportingContentItem,children:[e.jsx("h4",{className:ce.supportingContentItemHeader,children:d.title}),e.jsx("p",{className:ce.supportingContentItemText,dangerouslySetInnerHTML:{__html:d.content}})]},a)}),s?.map((i,a)=>e.jsx("img",{className:ce.supportingContentItemImage,src:i.url},a))]})};var O=(t=>(t.ThoughtProcessTab="thoughtProcess",t.SupportingContentTab="supportingContent",t.CitationTab="citation",t))(O||{});const Uo="_downloadButton_1o536_1",qo="_markdownViewer_1o536_6",Bo="_loading_1o536_15",Oo="_error_1o536_21",Vo="_markdown_1o536_6",D={downloadButton:Uo,markdownViewer:qo,loading:Bo,error:Oo,markdown:Vo},Go=({src:t})=>{const[n,s]=r.useState(""),[i,a]=r.useState(!0),[d,h]=r.useState(null),l=u=>{const p=/<a\s+(?:[^>]*?\s+)?href=['"](#[^"']*?)['"][^>]*?>/g;return u.replace(p,"")};return r.useEffect(()=>{(async()=>{try{const p=await fetch(t);if(!p.ok)throw new Error("Failed loading markdown file.");const b=await p.text(),w=await Cs.parse(b),y=l(w);s(y)}catch(p){h(p)}finally{a(!1)}})()},[t]),e.jsx("div",{children:i?e.jsx("div",{className:`${D.loading} ${D.markdownViewer}`,children:e.jsx($s,{size:Ds.large,label:"Loading file"})}):d?e.jsx("div",{className:`${D.error} ${D.markdownViewer}`,children:e.jsxs(Hs,{messageBarType:zs.error,isMultiline:!1,children:[d.message,e.jsx(Qs,{href:t,download:!0,children:"Download the file"})]})}):e.jsxs("div",{children:[e.jsx(X,{className:D.downloadButton,style:{color:"black"},iconProps:{iconName:"Save"},title:"Save",ariaLabel:"Save",href:t,download:!0}),e.jsx("div",{className:`${D.markdown} ${D.markdownViewer}`,dangerouslySetInnerHTML:{__html:n}})]})})},Nt={disabled:!0,style:{color:"grey"}},$o=({answer:t,activeTab:n,activeCitation:s,citationHeight:i,className:a,onActiveTabChanged:d})=>{t.context.thoughts;const h=!t.context.data_points,l=!s,[u,p]=r.useState(""),b=G?Z().instance:void 0,w=async()=>{const _=b?await he(b):void 0;if(s){const m=s.indexOf("#")?s.split("#")[1]:"",L=await(await fetch(s,{method:"GET",headers:await xe(_)})).blob();let C=URL.createObjectURL(L);m&&(C+="#"+m),p(C)}};r.useEffect(()=>{w()},[]);const y=()=>{if(!s)return null;const _=s.split(".").pop()?.toLowerCase();switch(console.log("File Extension"),console.log(_),_){case"png":return e.jsx("img",{src:u,className:Lo.citationImg,alt:"Citation Image"});case"md":return e.jsx(Go,{src:s});default:return e.jsx("iframe",{title:"Citation",src:u,width:"100%",height:i})}};return e.jsxs(Ws,{className:a,selectedKey:n,onLinkClick:_=>_&&d(_.props.itemKey),children:[e.jsx(Ct,{itemKey:O.SupportingContentTab,headerText:"Supporting content",headerButtonProps:h?Nt:void 0,children:e.jsx(Mo,{supportingContent:t.context.data_points})}),e.jsx(Ct,{itemKey:O.CitationTab,headerText:"Citation",headerButtonProps:l?Nt:void 0,children:y()})]})},Do="_container_cfwv2_1",Ho={container:Do},zo=({className:t,onClick:n})=>e.jsx("div",{className:`${Ho.container} ${t??""}`}),Qo="_container_cfwv2_1",Wo={container:Qo},Ko=({className:t,disabled:n,onClick:s})=>e.jsx("div",{className:`${Wo.container} ${t??""}`,children:e.jsx(Y,{icon:e.jsx(Mt,{}),disabled:n,onClick:s,children:"Clear chat"})}),Jo="_container_x2g71_1",Xo="_callout_x2g71_8",Yo="_list_x2g71_13",Zo="_item_x2g71_19",de={container:Jo,callout:Xo,list:Yo,item:Zo},ea=({className:t,disabled:n})=>{const[s,i]=r.useState(!1),[a,d]=r.useState(!1),[h,l]=r.useState(!0),[u,p]=r.useState({}),[b,w]=r.useState(),[y,_]=r.useState(),[m,S]=r.useState([]);if(!G)throw new Error("The UploadFile component requires useLogin to be true");const L=Z().instance,C=async()=>{i(!s);try{const f=await he(L);if(!f)throw new Error("No authentication token available");U(f)}catch(f){console.error(f),l(!1)}},U=async f=>{Rn(f).then(j=>{l(!1),p({}),S(j)})},ee=async f=>{p({...u,[f]:"pending"});try{const j=await he(L);if(!j)throw new Error("No authentication token available");await Nn(f,j),p({...u,[f]:"success"}),U(j)}catch(j){p({...u,[f]:"error"}),console.error(j)}},te=async f=>{if(f.preventDefault(),!f.target.files||f.target.files.length===0)return;d(!0);const j=f.target.files[0],fe=new FormData;fe.append("file",j);try{const $=await he(L);if(!$)throw new Error("No authentication token available");const je=await Fn(fe,$);w(je),d(!1),_(void 0),U($)}catch($){console.error($),d(!1),_("Error uploading file - please try again or contact admin.")}};return e.jsx("div",{className:`${de.container} ${t??""}`,children:e.jsxs("div",{children:[e.jsx(Y,{id:"calloutButton",icon:e.jsx(Bs,{}),disabled:n,onClick:C,children:"Uploads"}),s&&e.jsxs(Ut,{role:"dialog",gapSpace:0,className:de.callout,target:"#calloutButton",onDismiss:()=>i(!1),setInitialFocus:!0,children:[e.jsx("form",{encType:"multipart/form-data",children:e.jsxs("div",{children:[e.jsx(qt,{children:"Upload file:"}),e.jsx("input",{accept:".txt, .md, .json, .png, .jpg, .jpeg, .bmp, .heic, .tiff, .pdf, .docx, .xlsx, .pptx, .html",className:de.chooseFiles,type:"file",onChange:te})]})}),a&&e.jsx(le,{children:"Uploading files..."}),!a&&y&&e.jsx(le,{children:y}),!a&&b&&e.jsx(le,{children:b.message}),e.jsx("h3",{children:"Previously uploaded files:"}),h&&e.jsx(le,{children:"Loading..."}),!h&&m.length===0&&e.jsx(le,{children:"No files uploaded yet"}),m.map((f,j)=>e.jsxs("div",{className:de.list,children:[e.jsx("div",{className:de.item,children:f}),e.jsxs(Y,{icon:e.jsx(Mt,{}),onClick:()=>ee(f),disabled:u[f]==="pending"||u[f]==="success",children:[!u[f]&&"Delete file",u[f]=="pending"&&"Deleting file...",u[f]=="error"&&"Error deleting.",u[f]=="success"&&"File deleted"]})]},j))]})]})})},ta="_container_1pzrp_1",sa={container:ta},k={promptTemplate:"Overrides the prompt used to generate the answer based on the question and search results. To append to existing prompt instead of replace whole prompt, start your prompt with '>>>'.",temperature:"Sets the temperature of the request to the LLM that generates the answer. Higher temperatures result in more creative responses, but they may be less grounded.",searchScore:"Sets a minimum score for search results coming back from Azure AI search. The score range depends on whether you're using hybrid (default), vectors only, or text only.",rerankerScore:"Sets a minimum score for search results coming back from the semantic reranker. The score always ranges between 0-4. The higher the score, the more semantically relevant the result is to the question.",retrieveNumber:"Sets the number of search results to retrieve from Azure AI search. More results may increase the likelihood of finding the correct answer, but may lead to the model getting 'lost in the middle'.",excludeCategory:"Specifies a category to exclude from the search results. There are no categories used in the default data set.",useSemanticReranker:"Enables the Azure AI Search semantic ranker, a model that re-ranks search results based on semantic similarity to the user's query.",useSemanticCaptions:"Sends semantic captions to the LLM instead of the full search result. A semantic caption is extracted from a search result during the process of semantic ranking.",suggestFollowupQuestions:"Asks the LLM to suggest follow-up questions based on the user's query.",useGPT4Vision:"Uses GPT-4-Turbo with Vision to generate responses based on images and text from the index.",vectorFields:"Specifies which embedding fields in the Azure AI Search Index will be searched, both the 'Images and text' embeddings, 'Images' only, or 'Text' only.",gpt4VisionInputs:"Sets what will be sent to the vision model. 'Images and text' sends both images and text to the model, 'Images' sends only images, and 'Text' sends only text.",retrievalMode:"Sets the retrieval mode for the Azure AI Search query. `Vectors + Text (Hybrid)` uses a combination of vector search and full text search, `Vectors` uses only vector search, and `Text` uses only full text search. Hybrid is generally optimal.",streamChat:"Continuously streams the response to the chat UI as it is generated.",useOidSecurityFilter:"Filter search results based on the authenticated user's OID.",useGroupsSecurityFilter:"Filter search results based on the authenticated user's groups."},na=({updateRetrievalMode:t,updateVectorFields:n,showImageOptions:s,defaultRetrievalMode:i})=>{const[a,d]=r.useState(F.Hybrid),[h,l]=r.useState(M.Both),u=(m,S)=>{d(S?.data||F.Hybrid),t(S?.data||F.Hybrid)},p=(m,S)=>{l(S?.key),n([S?.key])};r.useEffect(()=>{n(s?[M.Embedding,M.ImageEmbedding]:[M.Embedding])},[s]);const b=g("retrievalMode"),w=g("retrievalModeField"),y=g("vectorFields"),_=g("vectorFieldsField");return e.jsxs(v,{className:sa.container,tokens:{childrenGap:10},children:[e.jsx(Pe,{id:w,label:"Retrieval mode",selectedKey:i.toString(),options:[{key:"hybrid",text:"Vectors + Text (Hybrid)",selected:a==F.Hybrid,data:F.Hybrid},{key:"vectors",text:"Vectors",selected:a==F.Vectors,data:F.Vectors},{key:"text",text:"Text",selected:a==F.Text,data:F.Text}],required:!0,onChange:u,"aria-labelledby":b,onRenderLabel:m=>e.jsx(I,{labelId:b,fieldId:w,helpText:k.retrievalMode,label:m?.label})}),s&&[F.Vectors,F.Hybrid].includes(a)&&e.jsx(Pe,{id:_,label:"Vector fields (Multi-query vector search)",options:[{key:M.Embedding,text:"Text Embeddings",selected:h===M.Embedding},{key:M.ImageEmbedding,text:"Image Embeddings",selected:h===M.ImageEmbedding},{key:M.Both,text:"Text and Image embeddings",selected:h===M.Both}],onChange:p,"aria-labelledby":y,onRenderLabel:m=>e.jsx(I,{labelId:y,fieldId:_,helpText:k.vectorFields,label:m?.label})})]})},oa=()=>{const{instance:t}=Z();t.getActiveAccount();const[n,s]=r.useState(void 0);r.useEffect(()=>{(async()=>{s(await In(t))})()},[]);const i=l=>typeof l=="string"?l:JSON.stringify(l),d=(l=>Object.keys(l??{}).map(u=>{let p=u;try{const w=new URL(u).pathname.split("/");u=w[w.length-1]}catch{}return{name:u,value:i((l??{})[p])}}))(n),h=[jt({columnId:"name",compare:(l,u)=>l.name.localeCompare(u.name),renderHeaderCell:()=>"Name",renderCell:l=>l.name}),jt({columnId:"value",compare:(l,u)=>l.value.localeCompare(u.value),renderHeaderCell:()=>"Value",renderCell:l=>l.value})];return e.jsxs("div",{children:[e.jsx(qt,{children:"ID Token Claims"}),e.jsxs(Ks,{items:d,columns:h,sortable:!0,getRowId:l=>l.name,children:[e.jsx(Js,{children:e.jsx(Tt,{children:({renderHeaderCell:l})=>e.jsx(Xs,{children:l()})})}),e.jsx(Ys,{children:({item:l,rowId:u})=>e.jsx(Tt,{children:({renderCell:p})=>e.jsx(Zs,{children:p(l)})},u)})]})]})},aa="_container_1pzrp_1",ra={container:aa},ia=({updateGPT4VInputs:t,updateUseGPT4V:n,isUseGPT4V:s,gpt4vInputs:i})=>{const[a,d]=r.useState(s),[h,l]=r.useState(i||V.TextAndImages),u=(m,S)=>{n(!!S),d(!!S)},p=(m,S)=>{if(S){const L=S.key;t(L||V.TextAndImages),L&&l(L)}};r.useEffect(()=>{a&&t(V.TextAndImages)},[a]);const b=g("useGPT4V"),w=g("useGPT4VField"),y=g("gpt4VInput"),_=g("gpt4VInputField");return e.jsxs(v,{className:ra.container,tokens:{childrenGap:10},children:[e.jsx(Q,{id:w,checked:a,label:"Use GPT vision model",onChange:u,"aria-labelledby":b,onRenderLabel:m=>e.jsx(I,{labelId:b,fieldId:w,helpText:k.useGPT4Vision,label:m?.label})}),a&&e.jsx(Pe,{id:_,selectedKey:h,label:"GPT vision model inputs",options:[{key:V.TextAndImages,text:"Images and text"},{text:"Images",key:V.Images},{text:"Text",key:V.Texts}],required:!0,onChange:p,"aria-labelledby":y,onRenderLabel:m=>e.jsx(I,{labelId:y,fieldId:_,helpText:k.gpt4VisionInputs,label:m?.label})})]})},la=()=>{const[t,n]=r.useState(!1),[s,i]=r.useState(""),[a,d]=r.useState(.3),[h,l]=r.useState(0),[u,p]=r.useState(0),[b,w]=r.useState(10),[y,_]=r.useState(F.Hybrid),[m,S]=r.useState(!0),[L,C]=r.useState(!0),[U,ee]=r.useState(!1),[te,f]=r.useState(""),[j,fe]=r.useState(!0),[$,je]=r.useState([M.Embedding]),[Oe,Gt]=r.useState(!1),[Ve,$t]=r.useState(!1),[Ge,Dt]=r.useState(V.TextAndImages),[be,Ht]=r.useState(!0),q=r.useRef(""),Te=r.useRef(null),[Se,_e]=r.useState(!1),[$e,Ie]=r.useState(!1),[ye,ke]=r.useState(),[De,Le]=r.useState(),[se,J]=r.useState(void 0),[ne,He]=r.useState(0),[T,Ae]=r.useState([]),[ze,Qe]=r.useState([]),[oe,zt]=r.useState([]),[We,Qt]=r.useState(!1),[Ke,Wt]=r.useState(!1),[Kt,Jt]=r.useState(!1),[Xt,Yt]=r.useState(!1),[Zt,es]=r.useState(!1),[Je,ts]=r.useState(!1),[Fe,ss]=r.useState(!1),ns=async()=>{kn().then(o=>{Qt(o.showGPT4VOptions),S(o.showSemanticRankerOption),Wt(o.showSemanticRankerOption),Jt(o.showVectorOption),o.showVectorOption||_(F.Text),Yt(o.showUserUpload),es(o.showSpeechInput),ts(o.showSpeechOutputBrowser),ss(o.showSpeechOutputAzure)})},os=async(o,c,E)=>{let ie="",R={};const B=P=>new Promise(Ss=>{setTimeout(()=>{ie+=P;const _s={...R,message:{content:ie,role:R.message.role}};Qe([...c,[o,_s]]),Ss(null)},33)});try{Ie(!0);for await(const P of js(E))if(P.context&&P.context.data_points)P.message=P.delta,R=P;else if(P.delta.content)_e(!1),await B(P.delta.content);else if(P.context)R.context={...R.context,...P.context};else if(P.error)throw Error(P.error)}finally{Ie(!1)}return{...R,message:{content:ie,role:R.message.role}}},Xe=G?Z().instance:void 0,{loggedIn:Ne}=r.useContext(ge),ae=async o=>{q.current=o,ye&&ke(void 0),_e(!0),Le(void 0),J(void 0);const c=Xe?await he(Xe):void 0;try{const ie={messages:[...T.flatMap(B=>[{content:B[0],role:"user"},{content:B[1].message.content,role:"assistant"}]),{content:o,role:"user"}],context:{overrides:{prompt_template:s.length===0?void 0:s,exclude_category:te.length===0?void 0:te,top:b,temperature:a,minimum_reranker_score:h,minimum_search_score:u,retrieval_mode:y,semantic_ranker:m,semantic_captions:U,suggest_followup_questions:j,use_oid_security_filter:Oe,use_groups_security_filter:Ve,vector_fields:$,use_gpt4v:be,gpt4v_input:Ge}},session_state:T.length?T[T.length-1][1].session_state:null},R=await Ln(ie,L,c);if(!R.body)throw Error("No response body");if(L){const B=await os(o,T,R.body);Ae([...T,[o,B]])}else{const B=await R.json();if(R.status>299||!R.ok)throw Error(B.error||"Unknown error");Ae([...T,[o,B]])}}catch(E){ke(E)}finally{_e(!1)}},as=()=>{q.current="",ye&&ke(void 0),Le(void 0),J(void 0),Ae([]),Qe([]),_e(!1),Ie(!1)};r.useEffect(()=>Te.current?.scrollIntoView({behavior:"smooth"}),[Se]),r.useEffect(()=>Te.current?.scrollIntoView({behavior:"auto"}),[ze]),r.useEffect(()=>{ns()},[]),r.useEffect(()=>{if(T&&Fe)for(let o=0;o<T.length;o++)oe[o]||An(T[o][1].message.content).then(c=>{zt([...oe.slice(0,o),c,...oe.slice(o+1)])})},[T]);const rs=(o,c)=>{i(c||"")},is=(o,c)=>{d(parseFloat(c||"0"))},ls=(o,c)=>{p(parseFloat(c||"0"))},cs=(o,c)=>{l(parseFloat(c||"0"))},ds=(o,c)=>{w(parseInt(c||"3"))},us=(o,c)=>{S(!!c)},hs=(o,c)=>{ee(!!c)},ps=(o,c)=>{C(!!c)},gs=(o,c)=>{f(c||"")},ms=(o,c)=>{fe(!!c)},xs=(o,c)=>{Gt(!!c)},fs=(o,c)=>{$t(!!c)},bs=o=>{ae(o)},Ye=(o,c)=>{De===o&&se===O.CitationTab&&ne===c?J(void 0):(Le(o),J(O.CitationTab)),He(c)},re=(o,c)=>{J(se===o&&ne===c?void 0:o),He(c)},Ze=g("promptTemplate"),et=g("promptTemplateField"),tt=g("temperature"),st=g("temperatureField"),nt=g("searchScore"),ot=g("searchScoreField"),at=g("rerankerScore"),rt=g("rerankerScoreField"),it=g("retrieveCount"),lt=g("retrieveCountField"),ct=g("excludeCategory"),dt=g("excludeCategoryField"),ut=g("semanticRanker"),ht=g("semanticRankerField"),pt=g("semanticCaptions"),gt=g("semanticCaptionsField"),mt=g("suggestFollowupQuestions"),xt=g("suggestFollowupQuestionsField"),ft=g("useOidSecurityFilter"),bt=g("useOidSecurityFilterField"),St=g("useGroupsSecurityFilter"),_t=g("useGroupsSecurityFilterField"),yt=g("shouldStream"),wt=g("shouldStreamField");return e.jsxs("div",{className:x.container,children:[e.jsxs("div",{className:x.commandsContainer,children:[e.jsx(Ko,{className:x.commandButton,onClick:as,disabled:!q.current||Se}),Xt&&e.jsx(ea,{className:x.commandButton,disabled:!Ne}),e.jsx(zo,{className:x.commandButton,onClick:()=>n(!t)})]}),e.jsxs("div",{className:x.chatRoot,children:[e.jsxs("div",{className:x.chatContainer,children:[q.current?e.jsxs("div",{className:x.chatMessageStream,children:[$e&&ze.map((o,c)=>e.jsxs("div",{children:[e.jsx(ve,{message:o[0]}),e.jsx("div",{className:x.chatMessageGpt,children:e.jsx(Lt,{isStreaming:!0,question:q.current,answer:o[1],isSelected:!1,onCitationClicked:E=>Ye(E,c),onThoughtProcessClicked:()=>re(O.ThoughtProcessTab,c),onSupportingContentClicked:()=>re(O.SupportingContentTab,c),onFollowupQuestionClicked:E=>ae(E),showFollowupQuestions:j&&T.length-1===c,showSpeechOutputAzure:Fe,showSpeechOutputBrowser:Je,speechUrl:oe[c]},c)})]},c)),!$e&&T.map((o,c)=>e.jsxs("div",{children:[e.jsx(ve,{message:o[0]}),e.jsx("div",{className:x.chatMessageGpt,children:e.jsx(Lt,{isStreaming:!1,question:q.current,answer:o[1],isSelected:ne===c&&se!==void 0,onCitationClicked:E=>Ye(E,c),onThoughtProcessClicked:()=>re(O.ThoughtProcessTab,c),onSupportingContentClicked:()=>re(O.SupportingContentTab,c),onFollowupQuestionClicked:E=>ae(E),showFollowupQuestions:j&&T.length-1===c,showSpeechOutputAzure:Fe,showSpeechOutputBrowser:Je,speechUrl:oe[c]},c)})]},c)),Se&&e.jsxs(e.Fragment,{children:[e.jsx(ve,{message:q.current}),e.jsx("div",{className:x.chatMessageGptMinWidth,children:e.jsx(to,{})})]}),ye?e.jsxs(e.Fragment,{children:[e.jsx(ve,{message:q.current}),e.jsx("div",{className:x.chatMessageGptMinWidth,children:e.jsx(so,{error:ye.toString(),onRetry:()=>ae(q.current)})})]}):null,e.jsx("div",{ref:Te})]}):e.jsxs("div",{className:x.chatEmptyState,children:[e.jsx(Os,{fontSize:"120px",primaryFill:"rgba(36,189,177,255)","aria-hidden":"true","aria-label":"Chat logo"}),e.jsx("h1",{className:x.chatEmptyStateTitle,children:"ANALYSIS AI"}),e.jsx("h2",{className:x.chatEmptyStateSubtitle,children:"Ask about the Auto or Airlines Industries"}),e.jsx(xo,{onExampleClicked:bs,useGPT4V:be})]}),e.jsx("div",{className:x.chatInput,children:e.jsx(lo,{clearOnSend:!0,placeholder:"Type a new question (e.g. What are Delta Air Lines earnings for 2024? )",disabled:Se,onSend:o=>ae(o),showSpeechInput:Zt})})]}),T.length>0&&se&&e.jsx($o,{className:x.chatAnalysisPanel,activeCitation:De,onActiveTabChanged:o=>re(o,ne),citationHeight:"810px",answer:T[ne][1],activeTab:se}),e.jsxs(en,{headerText:"Configure answer generation",isOpen:t,isBlocking:!1,onDismiss:()=>n(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e.jsx(qe,{onClick:()=>n(!1),children:"Close"}),isFooterAtBottom:!0,children:[e.jsx(z,{id:et,className:x.chatSettingsSeparator,defaultValue:s,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:rs,"aria-labelledby":Ze,onRenderLabel:o=>e.jsx(I,{labelId:Ze,fieldId:et,helpText:k.promptTemplate,label:o?.label})}),e.jsx(z,{id:st,className:x.chatSettingsSeparator,label:"Temperature",type:"number",min:0,max:1,step:.1,defaultValue:a.toString(),onChange:is,"aria-labelledby":tt,onRenderLabel:o=>e.jsx(I,{labelId:tt,fieldId:st,helpText:k.temperature,label:o?.label})}),e.jsx(z,{id:ot,className:x.chatSettingsSeparator,label:"Minimum search score",type:"number",min:0,step:.01,defaultValue:u.toString(),onChange:ls,"aria-labelledby":nt,onRenderLabel:o=>e.jsx(I,{labelId:nt,fieldId:ot,helpText:k.searchScore,label:o?.label})}),Ke&&e.jsx(z,{id:rt,className:x.chatSettingsSeparator,label:"Minimum reranker score",type:"number",min:1,max:4,step:.1,defaultValue:h.toString(),onChange:cs,"aria-labelledby":at,onRenderLabel:o=>e.jsx(I,{labelId:at,fieldId:rt,helpText:k.rerankerScore,label:o?.label})}),e.jsx(z,{id:lt,className:x.chatSettingsSeparator,label:"Retrieve this many search results:",type:"number",min:1,max:50,defaultValue:b.toString(),onChange:ds,"aria-labelledby":it,onRenderLabel:o=>e.jsx(I,{labelId:it,fieldId:lt,helpText:k.retrieveNumber,label:o?.label})}),e.jsx(z,{id:dt,className:x.chatSettingsSeparator,label:"Exclude category",defaultValue:te,onChange:gs,"aria-labelledby":ct,onRenderLabel:o=>e.jsx(I,{labelId:ct,fieldId:dt,helpText:k.excludeCategory,label:o?.label})}),Ke&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{id:ht,className:x.chatSettingsSeparator,checked:m,label:"Use semantic ranker for retrieval",onChange:us,"aria-labelledby":ut,onRenderLabel:o=>e.jsx(I,{labelId:ut,fieldId:ht,helpText:k.useSemanticReranker,label:o?.label})}),e.jsx(Q,{id:gt,className:x.chatSettingsSeparator,checked:U,label:"Use semantic captions",onChange:hs,disabled:!m,"aria-labelledby":pt,onRenderLabel:o=>e.jsx(I,{labelId:pt,fieldId:gt,helpText:k.useSemanticCaptions,label:o?.label})})]}),e.jsx(Q,{id:xt,className:x.chatSettingsSeparator,checked:j,label:"Suggest follow-up questions",onChange:ms,"aria-labelledby":mt,onRenderLabel:o=>e.jsx(I,{labelId:mt,fieldId:xt,helpText:k.suggestFollowupQuestions,label:o?.label})}),We&&e.jsx(ia,{gpt4vInputs:Ge,isUseGPT4V:be,updateUseGPT4V:o=>{Ht(o)},updateGPT4VInputs:o=>Dt(o)}),Kt&&e.jsx(na,{defaultRetrievalMode:y,showImageOptions:be&&We,updateVectorFields:o=>je(o),updateRetrievalMode:o=>_(o)}),G&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{id:bt,className:x.chatSettingsSeparator,checked:Oe||ue,label:"Use oid security filter",disabled:!Ne||ue,onChange:xs,"aria-labelledby":ft,onRenderLabel:o=>e.jsx(I,{labelId:ft,fieldId:bt,helpText:k.useOidSecurityFilter,label:o?.label})}),e.jsx(Q,{id:_t,className:x.chatSettingsSeparator,checked:Ve||ue,label:"Use groups security filter",disabled:!Ne||ue,onChange:fs,"aria-labelledby":St,onRenderLabel:o=>e.jsx(I,{labelId:St,fieldId:_t,helpText:k.useGroupsSecurityFilter,label:o?.label})})]}),e.jsx(Q,{id:wt,className:x.chatSettingsSeparator,checked:L,label:"Stream chat completion responses",onChange:ps,"aria-labelledby":yt,onRenderLabel:o=>e.jsx(I,{labelId:yt,fieldId:wt,helpText:k.streamChat,label:o?.label})}),G&&e.jsx(oa,{})]})]})]})},ca="_layout_tquw6_1",da="_header_tquw6_7",ua="_headerContainer_tquw6_12",ha="_headerTitleContainer_tquw6_20",pa="_headerLogo_tquw6_28",ga="_headerTitle_tquw6_20",ma="_headerNavList_tquw6_37",xa="_headerNavPageLink_tquw6_44",fa="_headerNavPageLinkActive_tquw6_58",ba="_headerNavLeftMargin_tquw6_63",Sa="_headerRightText_tquw6_67",_a="_headerNav_tquw6_37",ya="_headerRight_tquw6_67",wa="_microsoftLogo_tquw6_81",va="_githubLogo_tquw6_86",Ca="_navButton_tquw6_91",ja="_footerButton_tquw6_115",Ta="_downloadButton_tquw6_126",Ia="_footer_tquw6_115",H={layout:ca,header:da,headerContainer:ua,headerTitleContainer:ha,headerLogo:pa,headerTitle:ga,headerNavList:ma,headerNavPageLink:xa,headerNavPageLinkActive:fa,headerNavLeftMargin:ba,headerRightText:Sa,headerNav:_a,headerRight:ya,microsoftLogo:wa,githubLogo:va,navButton:Ca,footerButton:ja,downloadButton:Ta,footer:Ia},ka="_loginButton_ko7lg_1",La="_welcomeMessage_ko7lg_25",Rt={loginButton:ka,welcomeMessage:La},Aa=()=>{const{instance:t}=Z(),{loggedIn:n,setLoggedIn:s}=r.useContext(ge),i=t.getActiveAccount(),[a,d]=r.useState("");r.useEffect(()=>{(async()=>{d(await Ce(t)??"")})()},[]);const h=()=>{t.loginPopup({...vn,redirectUri:Bt()}).catch(u=>console.log(u)).then(async()=>{s(await Ee(t)),d(await Ce(t)??"")})},l=()=>{i?t.logoutPopup({mainWindowRedirectUri:"/",account:t.getActiveAccount()}).catch(u=>console.log(u)).then(async()=>{s(await Ee(t)),d(await Ce(t)??"")}):Tn()};return e.jsxs("div",{children:[a&&e.jsxs("span",{className:Rt.welcomeMessage,children:["Hello, ",a]}),e.jsx(qe,{text:n?"Logout":"Login",className:Rt.loginButton,onClick:n?l:h})]})},Fa="/assets/flatirons-b89b81bc.png",Pt=()=>{const{instance:t}=Z(),[n,s]=r.useState("");return r.useEffect(()=>{(async()=>{s(await Ce(t)??"")})()},[]),e.jsxs("div",{className:H.layout,children:[e.jsx("header",{className:H.header,role:"banner",children:e.jsxs("div",{className:H.headerContainer,children:[e.jsx(Ts,{to:"/",className:H.headerTitleContainer,children:e.jsx("img",{src:Fa,alt:"Logo",className:H.headerLogo})}),e.jsx("div",{className:H.headerRight,children:G&&e.jsx(Aa,{})})]})}),e.jsx(Is,{}),e.jsx("footer",{className:H.footer,role:"contentinfo"})]})},Na=()=>{const[t,n]=r.useState(!1);if(G){var s=new ks(wn);return!s.getActiveAccount()&&s.getAllAccounts().length>0&&s.setActiveAccount(s.getActiveAccount()),s.addEventCallback(i=>{if(i.eventType===Ls.LOGIN_SUCCESS&&i.payload){const a=i.payload;s.setActiveAccount(a)}}),r.useEffect(()=>{(async()=>{n(await Ee(s))})()},[]),e.jsx(As,{instance:s,children:e.jsx(ge.Provider,{value:{loggedIn:t,setLoggedIn:n},children:e.jsx(Pt,{})})})}else return e.jsx(ge.Provider,{value:{loggedIn:t,setLoggedIn:n},children:e.jsx(Pt,{})})};Fs();const Ra=Ns([{path:"/",element:e.jsx(Na,{}),children:[{index:!0,element:e.jsx(la,{})},{path:"*",lazy:()=>Es(()=>import("./NoPage-fb50c414.js"),["assets/NoPage-fb50c414.js","assets/vendor-2e98d0fc.js"])}]}]);Rs.createRoot(document.getElementById("root")).render(e.jsx(Ue.StrictMode,{children:e.jsx(Ps,{router:Ra})}));
//# sourceMappingURL=index-7038bd77.js.map
